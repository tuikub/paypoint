<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πâ‡πÅ‡∏¢‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts: Sarabun & Prompt -->
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f3f4f6;
            -webkit-user-select: none; /* Safari */
            -ms-user-select: none; /* IE 10 and IE 11 */
            user-select: none; /* Standard syntax */
        }
        h1, h2, h3, .font-prompt {
            font-family: 'Prompt', sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #FF6B00 0%, #FF8800 100%);
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        details > summary {
            list-style: none;
        }
        details > summary::-webkit-details-marker {
            display: none;
        }
        
        /* --- Styles ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á Chatbot Widget ‡πÉ‡∏´‡∏°‡πà --- */
        #chatbot-widget-container { 
            font-family: 'Sarabun', sans-serif; 
            z-index: 9999; 
        }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .typing-dot { animation: typing 1.4s infinite ease-in-out both; }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
        
        .chat-transition { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .chat-hidden { opacity: 0; transform: translateY(20px) scale(0.95); pointer-events: none; }
        .chat-visible { opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; }
        .animate-fade-in { animation: fadeIn 0.2s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Watermark Style */
        .watermark {
            position: fixed;
            bottom: 10px;
            left: 10px;
            font-size: 12px;
            color: rgba(0, 0, 0, 0.1);
            pointer-events: none;
            z-index: 0;
        }
    </style>
    
    <!-- Disable Right Click Script -->
    <script>
        document.addEventListener('contextmenu', event => event.preventDefault());
        document.onkeydown = function(e) {
            if(event.keyCode == 123) {
                return false;
            }
            if(e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
                return false;
            }
            if(e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) {
                return false;
            }
            if(e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
                return false;
            }
            if(e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
                return false;
            }
        }
    </script>
</head>
<body class="text-gray-800 relative min-h-screen">

    <!-- Watermark -->
    <div class="watermark">Copyright ¬© Paypoint Family System</div>

    <!-- Header Section -->
    <header class="gradient-bg text-white pb-12 pt-6 px-4 shadow-lg rounded-b-3xl relative z-10">
        <div class="max-w-3xl mx-auto">
            <!-- Back to Home Link -->
            <a href="#" onclick="alert('‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å')" class="inline-flex items-center text-white text-opacity-90 hover:text-opacity-100 hover:bg-white hover:bg-opacity-10 px-3 py-1.5 rounded-lg transition mb-2">
                <i class="fas fa-chevron-left mr-2"></i> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            </a>

            <div class="text-center">
                <div class="mb-4 inline-block p-3 bg-white bg-opacity-20 rounded-full">
                    <i class="fas fa-balance-scale text-3xl"></i>
                </div>
                <h1 class="text-2xl md:text-3xl font-bold mb-2">‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πâ‡πÅ‡∏¢‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö</h1>
                <p class="text-white text-opacity-90">‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á (Weight & Dimension Surcharge)</p>
                <div class="mt-4 inline-block bg-white text-orange-600 px-4 py-1 rounded-full text-sm font-bold shadow-sm">
                    ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏ü‡∏£‡∏ô‡πÑ‡∏ä‡∏™‡πå
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-3xl mx-auto px-4 -mt-8 pb-12 relative z-10">
        
        <!-- Warning Alert -->
        <div class="bg-white rounded-xl shadow-md p-6 mb-6 border-l-4 border-red-500 card-hover">
            <div class="flex items-start">
                <div class="flex-shrink-0">
                    <i class="fas fa-exclamation-triangle text-red-500 text-xl mt-1"></i>
                </div>
                <div class="ml-4">
                    <h3 class="text-lg font-bold text-red-600 mb-1">‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç!</h3>
                    <p class="text-gray-600">
                        ‡∏´‡πâ‡∏≤‡∏°‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° <span class="font-bold text-red-600">"‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö" (Accept)</span> ‡πÇ‡∏î‡∏¢‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î ‡∏´‡∏≤‡∏Å‡∏ó‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πâ‡πÅ‡∏¢‡πâ‡∏á ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ñ‡πâ‡∏≤‡∏Å‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏∑‡πà‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å
                    </p>
                </div>
            </div>
        </div>

        <!-- 3 Golden Rules -->
        <div class="grid md:grid-cols-3 gap-4 mb-8">
            <div class="bg-white p-5 rounded-xl shadow-sm text-center card-hover">
                <div class="w-12 h-12 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-calendar-alt text-xl"></i>
                </div>
                <h4 class="font-bold text-lg mb-2">5 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</h4>
                <p class="text-sm text-gray-500">‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏∑‡πà‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 5 ‡∏ß‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á</p>
            </div>
            <div class="bg-white p-5 rounded-xl shadow-sm text-center card-hover">
                <div class="w-12 h-12 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-undo-alt text-xl"></i>
                </div>
                <h4 class="font-bold text-lg mb-2">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</h4>
                <p class="text-sm text-gray-500">‡πÇ‡∏ï‡πâ‡πÅ‡∏¢‡πâ‡∏á‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏™‡∏î‡∏∏</p>
            </div>
            <div class="bg-white p-5 rounded-xl shadow-sm text-center card-hover">
                <div class="w-12 h-12 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-camera text-xl"></i>
                </div>
                <h4 class="font-bold text-lg mb-2">‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏ñ‡πà‡∏≤‡∏¢</h4>
                <p class="text-sm text-gray-500">‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏†‡∏≤‡∏û‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏ö‡∏ô‡∏ï‡∏≤‡∏ä‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡πà‡∏ô</p>
            </div>
        </div>

        <!-- Prevention Section -->
        <section class="bg-white rounded-xl shadow-md overflow-hidden mb-8">
            <div class="bg-gray-50 px-6 py-4 border-b border-gray-100">
                <h2 class="font-bold text-xl text-gray-800"><i class="fas fa-shield-alt text-green-500 mr-2"></i>‡∏ß‡∏¥‡∏ò‡∏µ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö</h2>
            </div>
            <div class="p-6">
                <ul class="space-y-4">
                    <li class="flex items-start">
                        <i class="fas fa-check-circle text-green-500 mt-1 mr-3"></i>
                        <div>
                            <span class="font-bold text-gray-800">‡∏Ñ‡∏µ‡∏¢‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á:</span>
                            <span class="text-gray-600">‡∏ß‡∏±‡∏î‡∏Ç‡∏ô‡∏≤‡∏î (‡∏Å‡∏ß‡πâ‡∏≤‡∏á x ‡∏¢‡∏≤‡∏ß x ‡∏™‡∏π‡∏á) ‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡πà‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πä‡∏∞ ‡∏≠‡∏¢‡πà‡∏≤‡∏Å‡∏∞‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏≤‡∏¢‡∏ï‡∏≤</span>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-check-circle text-green-500 mt-1 mr-3"></i>
                        <div>
                            <span class="font-bold text-gray-800">‡πÄ‡∏Å‡πá‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏ä‡∏¥‡πâ‡∏ô:</span>
                            <span class="text-gray-600">‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏ß‡∏≤‡∏á‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ä‡∏±‡πà‡∏á ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏¢‡∏ß‡∏±‡∏î‡∏Ç‡∏ô‡∏≤‡∏î ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏´‡∏£‡∏∑‡∏≠ Cloud</span>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-check-circle text-green-500 mt-1 mr-3"></i>
                        <div>
                            <span class="font-bold text-gray-800">‡πÉ‡∏ä‡πâ Web Cam:</span>
                            <span class="text-gray-600">‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á Web Cam ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏†‡∏≤‡∏û‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏Ç‡∏ì‡∏∞‡∏Ñ‡∏µ‡∏¢‡πå‡∏á‡∏≤‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</span>
                        </div>
                    </li>
                </ul>
            </div>
        </section>

        <!-- Q&A Section -->
        <section class="mb-8">
            <h2 class="font-bold text-2xl text-gray-800 mb-4 px-2">‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö ‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢ (Q&A)</h2>
            
            <div class="space-y-3">
                <!-- Q1 -->
                <details class="group bg-white rounded-xl shadow-sm">
                    <summary class="flex justify-between items-center font-medium cursor-pointer list-none p-5 text-gray-800 hover:bg-gray-50 rounded-xl transition">
                        <span><i class="fas fa-question-circle text-orange-500 mr-2"></i> ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏≠‡∏∞‡πÑ‡∏£?</span>
                        <span class="transition group-open:rotate-180">
                            <i class="fas fa-chevron-down text-gray-400"></i>
                        </span>
                    </summary>
                    <div class="text-gray-600 mt-0 px-5 pb-5 border-t border-gray-100 pt-3">
                        ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏Ç‡∏≤‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö <strong>"‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤"</strong> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Hub) ‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∂‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°
                    </div>
                </details>

                <!-- Q2 -->
                <details class="group bg-white rounded-xl shadow-sm">
                    <summary class="flex justify-between items-center font-medium cursor-pointer list-none p-5 text-gray-800 hover:bg-gray-50 rounded-xl transition">
                        <span><i class="fas fa-clock text-orange-500 mr-2"></i> ‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏´‡∏±‡∏Å‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏≠‡∏ô‡πÑ‡∏´‡∏ô?</span>
                        <span class="transition group-open:rotate-180">
                            <i class="fas fa-chevron-down text-gray-400"></i>
                        </span>
                    </summary>
                    <div class="text-gray-600 mt-0 px-5 pb-5 border-t border-gray-100 pt-3">
                        <ul class="list-disc pl-5 space-y-1">
                            <li>‡∏´‡∏≤‡∏Å‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á<strong>‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô</strong> ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤: ‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏´‡∏±‡∏Å‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</li>
                            <li>‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏´‡∏±‡∏Å‡πÄ‡∏á‡∏¥‡∏ô: ‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 2 ‡∏£‡∏≠‡∏ö ‡∏Ñ‡∏∑‡∏≠ <strong>10:00 ‡∏ô.</strong> ‡πÅ‡∏•‡∏∞ <strong>16:00 ‡∏ô.</strong></li>
                            <li>‡∏´‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏û‡∏≠: ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏£‡∏≠‡∏´‡∏±‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏à‡∏ô‡∏Ñ‡∏£‡∏ö‡∏¢‡∏≠‡∏î</li>
                        </ul>
                    </div>
                </details>

                <!-- Q3 -->
                <details class="group bg-white rounded-xl shadow-sm">
                    <summary class="flex justify-between items-center font-medium cursor-pointer list-none p-5 text-gray-800 hover:bg-gray-50 rounded-xl transition">
                        <span><i class="fas fa-file-upload text-orange-500 mr-2"></i> ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡πà‡∏ô?</span>
                        <span class="transition group-open:rotate-180">
                            <i class="fas fa-chevron-down text-gray-400"></i>
                        </span>
                    </summary>
                    <div class="text-gray-600 mt-0 px-5 pb-5 border-t border-gray-100 pt-3">
                        ‡∏ó‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå .jpg, .png, .pdf) ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5 MB
                        <br><strong>‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</strong> ‡∏†‡∏≤‡∏û‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡πÄ‡∏´‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ö‡∏ô‡∏ï‡∏≤‡∏ä‡∏±‡πà‡∏á ‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏™‡∏†‡∏≤‡∏û‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏û‡∏±‡∏™‡∏î‡∏∏
                    </div>
                </details>
            </div>
        </section>

        <!-- Resources / Links Section -->
        <section class="bg-gray-800 text-white rounded-xl shadow-md p-6">
            <h2 class="font-bold text-xl mb-4"><i class="fas fa-video mr-2"></i>‡∏™‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h2>
            
            <div class="grid md:grid-cols-2 gap-4">
                <a href="#" class="block bg-gray-700 hover:bg-gray-600 transition p-4 rounded-lg flex items-center">
                    <div class="w-12 h-12 bg-red-600 rounded-full flex items-center justify-center flex-shrink-0 mr-4">
                        <i class="fas fa-play text-white"></i>
                    </div>
                    <div>
                        <h4 class="font-bold text-sm">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πâ‡πÅ‡∏¢‡πâ‡∏á (‡∏Ñ‡∏•‡∏¥‡∏õ 1)</h4>
                        <p class="text-xs text-gray-400">‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏ä‡∏°‡∏ú‡πà‡∏≤‡∏ô YouTube</p>
                    </div>
                </a>

                <a href="#" class="block bg-gray-700 hover:bg-gray-600 transition p-4 rounded-lg flex items-center">
                    <div class="w-12 h-12 bg-red-600 rounded-full flex items-center justify-center flex-shrink-0 mr-4">
                        <i class="fas fa-play text-white"></i>
                    </div>
                    <div>
                        <h4 class="font-bold text-sm">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πâ‡πÅ‡∏¢‡πâ‡∏á (‡∏Ñ‡∏•‡∏¥‡∏õ 2)</h4>
                        <p class="text-xs text-gray-400">‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏ä‡∏°‡∏ú‡πà‡∏≤‡∏ô YouTube</p>
                    </div>
                </a>
            </div>

            <div class="mt-4 pt-4 border-t border-gray-700 flex flex-col md:flex-row gap-3">
                <a href="#" class="flex-1 text-center bg-orange-600 hover:bg-orange-700 text-white py-2 rounded-lg transition font-medium">
                    <i class="fas fa-book-open mr-2"></i>‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (PDF)
                </a>
                <a href="#" class="flex-1 text-center bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg transition font-medium">
                    <i class="fab fa-google-drive mr-2"></i>‡∏Ñ‡∏•‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Drive)
                </a>
            </div>
        </section>

        <!-- Footer -->
        <footer class="text-center mt-8 text-gray-500 text-sm pb-8">
            <p>&copy; 2024 PAYPOINT FAMILY SYSTEM SUPPORT. ALL RIGHTS RESERVED</p>
            <p class="mt-1">Pratya Chatmontree</p>
            <a href="#" class="inline-block mt-2 text-orange-500 hover:text-orange-600 font-medium">‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        </footer>

    </main>

    <!-- ========================================================================================== -->
    <!-- ‡∏™‡πà‡∏ß‡∏ô Chatbot Widget (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Google Sheets + Together.ai Fallback) -->
    <!-- ========================================================================================== -->
    <div id="chatbot-widget-container" class="fixed bottom-4 right-4 flex flex-col items-end gap-4">
        
        <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á Chatbot -->
        <div id="chat-window" class="chat-hidden chat-transition bg-white w-[350px] h-[500px] max-h-[80vh] rounded-2xl shadow-2xl flex flex-col overflow-hidden border border-gray-200">
            
            <!-- Header -->
            <div class="bg-gradient-to-r from-orange-600 to-red-600 p-4 flex items-center justify-between text-white shadow-md z-10">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white font-bold relative">
                        <i class="fa-solid fa-robot"></i>
                        <!-- Status Dot: Green=Ready, Red=Error -->
                        <div id="status-dot" class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-400 border-2 border-orange-600 rounded-full"></div>
                    </div>
                    <div>
                        <h1 class="font-bold text-base leading-tight">AI Assistant</h1>
                        <p id="model-status" class="text-[10px] text-orange-100 opacity-90">Powered by Gemini</p>
                    </div>
                </div>
                <div class="flex gap-2">
                    <button onclick="checkAdminAndToggle()" class="opacity-0 hover:opacity-100 text-white/80 hover:text-white p-1 rounded-full transition" title="‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API">
                        <i class="fa-solid fa-gear"></i>
                    </button>
                    <button onclick="toggleChat()" class="text-white/80 hover:text-white p-1 rounded-full transition">
                        <i class="fa-solid fa-xmark text-lg"></i>
                    </button>
                </div>
            </div>

            <!-- Chat Box -->
            <div id="chat-box" class="flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 scrollbar-hide text-sm relative">
                <div class="flex items-start gap-2">
                    <div class="w-6 h-6 rounded-full bg-orange-100 flex items-center justify-center text-orange-600 text-[10px] font-bold shrink-0">AI</div>
                    <div class="bg-white p-3 rounded-2xl rounded-tl-none shadow-sm border border-gray-100 text-gray-800">
                        ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πâ‡πÅ‡∏¢‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ñ‡∏≤‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ()
                    </div>
                </div>
            </div>

            <!-- Loading -->
            <div id="loading" class="hidden px-4 pb-2">
                <div class="flex items-center space-x-1 bg-white p-2 rounded-xl w-fit shadow-sm border border-gray-100">
                    <div class="w-1.5 h-1.5 bg-orange-600 rounded-full typing-dot"></div>
                    <div class="w-1.5 h-1.5 bg-orange-600 rounded-full typing-dot"></div>
                    <div class="w-1.5 h-1.5 bg-orange-600 rounded-full typing-dot"></div>
                </div>
            </div>

            <!-- Input Form -->
            <div class="p-3 bg-white border-t border-gray-100">
                <form id="chat-form" class="flex gap-2 items-center">
                    <input type="text" id="user-input" 
                        class="flex-1 bg-gray-100 border-0 text-gray-900 text-sm rounded-full focus:ring-2 focus:ring-orange-500 block w-full px-4 py-2.5 outline-none transition placeholder-gray-400" 
                        placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°..." autocomplete="off">
                    <button type="submit" 
                        class="bg-orange-600 hover:bg-orange-700 text-white rounded-full w-10 h-10 flex items-center justify-center shadow-md transition transform hover:scale-105">
                        <i class="fa-solid fa-paper-plane text-xs"></i>
                    </button>
                </form>
            </div>

            <!-- Settings Panel (‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà) -->
            <div id="settings-panel" class="hidden absolute inset-0 bg-white z-20 flex flex-col p-5 animate-fade-in">
                <h3 class="font-bold text-gray-700 mb-4 flex items-center gap-2"><i class="fa-solid fa-sliders"></i> ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h3>
                
                <div class="space-y-3 flex-1 overflow-y-auto">
                    <div>
                        <label class="text-xs font-semibold text-gray-600">Google Sheet ID:</label>
                        <input type="text" id="sheet-id-input" class="w-full border rounded p-2 text-xs mt-1 bg-gray-50" value="1darv2F3vLlv5hhULgRREzRXPkKy0L2GmTFeyfzNgo9k">
                        <p class="text-[10px] text-gray-400 mt-1">*‡∏ï‡πâ‡∏≠‡∏á Publish to Web ‡πÄ‡∏õ‡πá‡∏ô CSV ‡∏Å‡πà‡∏≠‡∏ô</p>
                    </div>
                    
                    <hr class="border-gray-100 my-2">

                    <div>
                        <label class="text-xs font-semibold text-orange-600">Primary: Gemini API Key</label>
                        <input type="password" id="gemini-key-input" class="w-full border border-orange-200 rounded p-2 text-xs mt-1" placeholder="‡∏ß‡∏≤‡∏á API Key ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (AIzaSy...)">
                    </div>

                    <div>
                        <label class="text-xs font-semibold text-purple-600">Fallback: Together.ai Key</label>
                        <input type="password" id="together-key-input" class="w-full border border-purple-200 rounded p-2 text-xs mt-1" placeholder="‡∏ß‡∏≤‡∏á API Key ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà">
                        <p class="text-[10px] text-gray-400 mt-1">*‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Gemini ‡πÄ‡∏ï‡πá‡∏° (Llama 3.2 3B)</p>
                    </div>
                </div>

                <div class="mt-4 flex gap-2">
                    <button onclick="toggleSettings()" class="flex-1 py-2 text-gray-500 text-xs hover:bg-gray-100 rounded">‡∏õ‡∏¥‡∏î</button>
                    <button onclick="saveSettings()" class="flex-1 py-2 bg-orange-600 text-white text-xs rounded hover:bg-orange-700 shadow">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å & ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î</button>
                </div>
            </div>
        </div>

        <!-- Toggle Button -->
        <button onclick="toggleChat()" id="chat-toggle-btn" 
            class="bg-orange-600 hover:bg-orange-700 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center transition-transform hover:scale-110 group relative">
            <i class="fa-solid fa-comment-dots text-2xl absolute transition-all duration-300 transform group-hover:rotate-12 scale-100 opacity-100" id="icon-closed"></i>
            <i class="fa-solid fa-chevron-down text-xl absolute transition-all duration-300 transform rotate-180 scale-0 opacity-0" id="icon-opened"></i>
        </button>
    </div>

    <script>
        // --- 1. ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏£‡∏∞‡∏ö‡∏ö ---
        let sheetId = localStorage.getItem('chat_sheet_id') || '1darv2F3vLlv5hhULgRREzRXPkKy0L2GmTFeyfzNgo9k';
        
        // =========================================================================
        // üîë ‡πÉ‡∏™‡πà API KEY (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤ UI Settings ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢)
        // =========================================================================
        
        // Clear default keys to avoid invalid key errors
        let geminiKey = localStorage.getItem('chat_gemini_key') || 'AIzaSyAnqjmk-VxP-XAVVnddpua394Pw71NtVfU'; 
        
        let togetherKey = localStorage.getItem('chat_together_key') || 'f1ab2db1ed0da368ff5d3001a70855fac21f2b161a12021e44c1e3e75f05e575'; 
        
        let KNOWLEDGE_BASE = "";
        let isKnowledgeLoaded = false;

        // --- 2. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ---
        document.addEventListener('DOMContentLoaded', () => {
            // ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡πà‡∏≤‡∏•‡∏á‡πÉ‡∏ô Input Settings
            document.getElementById('sheet-id-input').value = sheetId;
            document.getElementById('gemini-key-input').value = geminiKey;
            document.getElementById('together-key-input').value = togetherKey;
            
            if(sheetId) fetchSheetData();
        });

        // --- 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á Google Sheet (CSV) ---
        async function fetchSheetData() {
            try {
                // ‡πÉ‡∏ä‡πâ URL export?format=csv
                const url = `https://docs.google.com/spreadsheets/d/${sheetId}/export?format=csv`;
                const response = await fetch(url);
                
                if (!response.ok) throw new Error("‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ (‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏° Publish to Web)");
                
                const csvText = await response.text();
                parseCSVtoKnowledge(csvText);
                
                addMessage('system', '‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏£‡∏±‡∏ö');
                document.getElementById('status-dot').className = "absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-400 border-2 border-orange-600 rounded-full";
                isKnowledgeLoaded = true;

            } catch (error) {
                console.error(error);
                addMessage('system', '‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Sheet ‡πÑ‡∏î‡πâ: ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ID ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ "Publish to Web" (File > Share > Publish to web)');
                document.getElementById('status-dot').className = "absolute bottom-0 right-0 w-2.5 h-2.5 bg-red-500 border-2 border-orange-600 rounded-full";
            }
        }

        function parseCSVtoKnowledge(csv) {
            // ‡πÅ‡∏õ‡∏•‡∏á CSV ‡∏á‡πà‡∏≤‡∏¢‡πÜ (Assume: Col A = ‡∏ñ‡∏≤‡∏°, Col B = ‡∏ï‡∏≠‡∏ö)
            const rows = csv.split('\n').map(row => row.split(','));
            let textData = "# ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö (Q&A Knowledge Base)\n";
            
            rows.forEach((cols, index) => {
                if(index === 0) return; // ‡∏Ç‡πâ‡∏≤‡∏° Header
                if(cols.length >= 2) {
                    // ‡∏ï‡∏±‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏û‡∏π‡∏î‡∏≠‡∏≠‡∏Å (Clean CSV quotes)
                    const q = cols[0] ? cols[0].replace(/^"|"$/g, '').trim() : '';
                    const a = cols[1] ? cols[1].replace(/^"|"$/g, '').trim() : '';
                    if(q && a) {
                        textData += `- ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: "${q}" \n  ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö: "${a}"\n`;
                    }
                }
            });
            KNOWLEDGE_BASE = textData;
        }

        // --- 4. Logic ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å AI (Chain: Gemini -> Together) ---
        async function getAIResponse(userMessage) {
            if (!geminiKey && !togetherKey) {
                return "API";
            }

            // ‡∏•‡∏≠‡∏á Gemini ‡∏Å‡πà‡∏≠‡∏ô (Priority 1)
            if (geminiKey) {
                document.getElementById('model-status').innerText = "Generating with Gemini...";
                try {
                    return await callGemini(userMessage);
                } catch (error) {
                    console.warn("Gemini Failed:", error);
                    // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ Together Key ‡πÉ‡∏´‡πâ‡πÑ‡∏õ‡∏ï‡πà‡∏≠
                    if (togetherKey) {
                        addMessage('system', '‚ö†Ô∏è ‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡∏ô‡∏ô‡∏∞');
                    } else {
                        return "‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢ Gemini ‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ Key ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ö (" + error.message + ")";
                    }
                }
            }

            // ‡∏ñ‡πâ‡∏≤ Gemini ‡∏û‡∏•‡∏≤‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ Key -> ‡∏•‡∏≠‡∏á Together (Fallback)
            if (togetherKey) {
                document.getElementById('model-status').innerText = "Fallback: Llama 3.2 (Together.ai)";
                try {
                    return await callTogetherAI(userMessage);
                } catch (error) {
                    console.error("Together AI Failed:", error);
                    return "‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á 2 ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á";
                }
            }
            
            return "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà API Key ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡∏ö";
        }

        // --- 4.1 Gemini API (Flash 1.5) ---
        async function callGemini(message) {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${geminiKey}`;
            const prompt = `
            Role: ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ AI Support ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Context ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
            Context: ${KNOWLEDGE_BASE}
            User Question: ${message}
            Instruction: ‡∏ï‡∏≠‡∏ö‡∏™‡∏±‡πâ‡∏ô ‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö ‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö`;

            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });
            
            const data = await response.json();
            if (data.error) throw new Error(data.error.message);
            
            // Reset Status UI
            document.getElementById('model-status').innerText = "Powered by Gemini";
            return data.candidates[0].content.parts[0].text;
        }

        // --- 4.2 Together AI API (Llama 3.2 3B) ---
        async function callTogetherAI(message) {
            const url = "https://api.together.xyz/v1/chat/completions";
            const promptSystem = `Context: ${KNOWLEDGE_BASE}\nInstruction: Answer in Thai based on context.`;
            
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${togetherKey}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    model: "meta-llama/Llama-3.2-3B-Instruct-Turbo",
                    messages: [
                        { role: "system", content: promptSystem },
                        { role: "user", content: message }
                    ],
                    max_tokens: 512,
                    temperature: 0.7
                })
            });

            const data = await response.json();
            if (data.error) throw new Error(data.error.message);
            
            return data.choices[0].message.content;
        }

        // --- 5. UI Helpers ---
        const chatWindow = document.getElementById('chat-window');
        const chatBox = document.getElementById('chat-box');
        const userInput = document.getElementById('user-input');
        const loading = document.getElementById('loading');
        const settingsPanel = document.getElementById('settings-panel');

        function toggleChat() {
            const isHidden = chatWindow.classList.contains('chat-hidden');
            if (isHidden) {
                chatWindow.classList.remove('chat-hidden');
                chatWindow.classList.add('chat-visible');
                document.getElementById('icon-closed').classList.add('scale-0', 'opacity-0');
                document.getElementById('icon-opened').classList.remove('scale-0', 'opacity-0', 'rotate-180');
                setTimeout(() => userInput.focus(), 100);
            } else {
                chatWindow.classList.add('chat-hidden');
                chatWindow.classList.remove('chat-visible');
                document.getElementById('icon-closed').classList.remove('scale-0', 'opacity-0');
                document.getElementById('icon-opened').classList.add('scale-0', 'opacity-0', 'rotate-180');
            }
        }

        function checkAdminAndToggle() {
            const password = prompt("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô Admin:");
            if (password === "02817648++") {
                toggleSettings();
            } else {
                alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!");
            }
        }

        function toggleSettings() {
            settingsPanel.classList.toggle('hidden');
        }

        function saveSettings() {
            sheetId = document.getElementById('sheet-id-input').value.trim();
            geminiKey = document.getElementById('gemini-key-input').value.trim();
            togetherKey = document.getElementById('together-key-input').value.trim();

            localStorage.setItem('chat_sheet_id', sheetId);
            localStorage.setItem('chat_gemini_key', geminiKey);
            localStorage.setItem('chat_together_key', togetherKey);

            addMessage('system', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß... ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà');
            toggleSettings();
            fetchSheetData(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
        }

        function addMessage(role, text) {
            const isUser = role === 'user';
            const div = document.createElement('div');
            div.className = `flex items-start gap-2 ${isUser ? 'flex-row-reverse' : ''}`;
            
            const avatar = isUser ? '' : `<div class="w-6 h-6 rounded-full bg-orange-100 flex items-center justify-center text-orange-600 text-[10px] font-bold shrink-0">AI</div>`;
            const bubbleColor = isUser ? 'bg-orange-600 text-white' : 'bg-white text-gray-800 border border-gray-100';
            const systemStyle = role === 'system' ? 'bg-yellow-50 text-yellow-800 border-yellow-100 text-xs italic' : '';

            div.innerHTML = `
                ${role === 'system' ? '' : avatar}
                <div class="max-w-[85%] p-2.5 px-3 ${role === 'system' ? systemStyle : bubbleColor} rounded-2xl ${isUser ? 'rounded-tr-none' : 'rounded-tl-none'} shadow-sm text-sm leading-relaxed break-words">
                    ${text}
                </div>
            `;
            chatBox.appendChild(div);
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        document.getElementById('chat-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const text = userInput.value.trim();
            if (!text) return;

            addMessage('user', text);
            userInput.value = '';
            loading.classList.remove('hidden');
            
            const reply = await getAIResponse(text);
            
            loading.classList.add('hidden');
            addMessage('ai', reply);
        });
    </script>
</body>
</html>
