<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paypoint AI Assistant</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Prompt Font (Thai) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Prompt', sans-serif;
            background-color: #f3f4f6;
        }
        /* Custom Scrollbar */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .chat-message {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .typing-dot {
            animation: typing 1.4s infinite ease-in-out both;
        }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-child:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
    </style>
</head>
<body class="h-screen flex items-center justify-center relative overflow-hidden">

    <!-- Mockup Background Content -->
    <div class="text-center p-8 max-w-2xl">
        <h1 class="text-4xl font-bold text-gray-800 mb-4">Paypoint Service</h1>
        <p class="text-gray-600 mb-8">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‡πÄ‡∏Ñ‡∏•‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ</p>
        <div class="p-6 bg-white rounded-xl shadow-md">
            <i class="fa-solid fa-box-open text-5xl text-blue-500 mb-4"></i>
            <p>‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (Chatbot ‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏•‡πà‡∏≤‡∏á)</p>
        </div>
    </div>

    <!-- CHATBOT WIDGET START -->
    <div id="chat-widget" class="fixed bottom-4 right-4 z-50 flex flex-col items-end">
        
        <!-- Chat Window -->
        <div id="chat-window" class="hidden w-[350px] h-[500px] bg-white rounded-2xl shadow-2xl flex-col overflow-hidden mb-4 border border-gray-200 transition-all duration-300 transform origin-bottom-right scale-95 opacity-0">
            
            <!-- Header -->
            <div class="bg-gradient-to-r from-blue-600 to-indigo-600 p-4 flex justify-between items-center text-white shadow-md">
                <div class="flex items-center gap-3">
                    <div class="relative">
                        <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-blue-600 font-bold text-xl shadow-sm">
                            <i class="fa-solid fa-robot"></i>
                        </div>
                        <span class="absolute bottom-0 right-0 w-3 h-3 bg-green-400 border-2 border-white rounded-full"></span>
                    </div>
                    <div>
                        <h3 class="font-bold text-lg leading-tight">‡∏ô‡πâ‡∏≠‡∏á AI Paypoint</h3>
                        <p class="text-xs text-blue-100 opacity-90">‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</p>
                    </div>
                </div>
                <button onclick="toggleChat()" class="text-white hover:bg-white/20 p-2 rounded-full transition">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>

            <!-- Chat Body -->
            <div id="chat-messages" class="flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 scrollbar-hide">
                <!-- Welcome Message -->
                <div class="chat-message flex items-start gap-2.5">
                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-xs shrink-0">
                        <i class="fa-solid fa-robot"></i>
                    </div>
                    <div class="flex flex-col gap-1 max-w-[85%]">
                        <div class="bg-white p-3 rounded-2xl rounded-tl-none shadow-sm text-sm text-gray-700 border border-gray-100">
                            ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! üôè ‡∏ú‡∏°‡∏Ñ‡∏∑‡∏≠ AI ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≤‡∏Å Paypoint <br>
                            ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏±‡∏ö ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏∞‡πÑ‡∏£‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö?
                            <ul class="mt-2 space-y-1">
                                <li>üì¶ <span class="text-blue-500 cursor-pointer hover:underline" onclick="sendQuickMsg('‡πÄ‡∏ä‡πá‡∏Ñ‡∏û‡∏±‡∏™‡∏î‡∏∏')">‡πÄ‡∏ä‡πá‡∏Ñ‡∏û‡∏±‡∏™‡∏î‡∏∏</span></li>
                                <li>üí∞ <span class="text-blue-500 cursor-pointer hover:underline" onclick="sendQuickMsg('‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á')">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á</span></li>
                                <li>‚ö†Ô∏è <span class="text-blue-500 cursor-pointer hover:underline" onclick="sendQuickMsg('‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á/‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á')">‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á/‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á</span></li>
                            </ul>
                        </div>
                        <span class="text-[10px] text-gray-400 ml-1">AI Assistant</span>
                    </div>
                </div>
            </div>

            <!-- Loading Indicator -->
            <div id="loading-indicator" class="hidden px-4 pb-2">
                <div class="flex items-center gap-1 text-gray-400 text-xs ml-10">
                    <span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</span>
                    <span class="typing-dot text-lg">.</span>
                    <span class="typing-dot text-lg">.</span>
                    <span class="typing-dot text-lg">.</span>
                </div>
            </div>

            <!-- Input Area -->
            <div class="p-3 bg-white border-t border-gray-100 flex gap-2 items-center">
                <input type="text" id="user-input" 
                    class="flex-1 bg-gray-100 text-gray-700 text-sm rounded-full px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:bg-white transition"
                    placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." 
                    onkeypress="handleKeyPress(event)">
                <button onclick="sendMessage()" 
                    class="w-10 h-10 bg-blue-600 hover:bg-blue-700 text-white rounded-full flex items-center justify-center shadow-md transition transform hover:scale-105 active:scale-95">
                    <i class="fa-solid fa-paper-plane text-sm"></i>
                </button>
            </div>
        </div>

        <!-- Toggle Button -->
        <button id="chat-toggle-btn" onclick="toggleChat()" 
            class="w-14 h-14 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-full shadow-lg flex items-center justify-center transition transform hover:scale-110 hover:shadow-xl group">
            <i class="fa-solid fa-comment-dots text-2xl group-hover:scale-110 transition"></i>
        </button>
    </div>

    <!-- Script -->
    <script>
        // --- 1. KNOWLEDGE BASE (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets) ---
        // A = Keywords, B = Response, C = Link
        const knowledgeBase = [
            {
                keywords: ["‡πÄ‡∏ä‡πá‡∏Ñ‡∏û‡∏±‡∏™‡∏î‡∏∏", "‡∏ï‡∏≤‡∏°‡∏Ç‡∏≠‡∏á", "‡∏Ç‡∏≠‡∏á‡∏ñ‡∏∂‡∏á‡πÑ‡∏´‡∏ô", "tracking", "track", "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞", "‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏•‡∏Ç"],
                response: "‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏û‡∏±‡∏™‡∏î‡∏∏‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Å‡∏î‡πÄ‡∏°‡∏ô‡∏π '‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞' ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö",
                link: "https://tuikub.github.io/tracking/tracking.html",
                linkText: "üîç ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏û‡∏±‡∏™‡∏î‡∏∏"
            },
            {
                keywords: ["‡πÄ‡∏ä‡πá‡∏Ñ‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô", "‡∏´‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠", "‡πÄ‡∏•‡∏Ç‡∏ú‡∏¥‡∏î", "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"],
                response: "‡∏ñ‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡∏™‡πà‡∏á‡∏ô‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏±‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏ß‡∏£‡πå‡∏Ñ‡∏£‡∏±‡∏ö",
                link: "https://tuikub.github.io/tracking/tracking.html",
                linkText: "‡∏•‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á"
            },
            {
                keywords: ["‡∏Ç‡∏≠‡∏á‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á", "‡∏™‡πà‡∏á‡∏ä‡πâ‡∏≤", "‡∏ô‡∏≤‡∏ô‡∏à‡∏±‡∏á", "‡∏Ñ‡πâ‡∏≤‡∏á"],
                response: "‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÄ‡∏¢‡∏≠‡∏∞‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á ‡πÅ‡∏ï‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡πà‡∏á‡∏ô‡∏≥‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö",
                link: "https://tuikub.github.io/tracking/tracking.html",
                linkText: "‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"
            },
            {
                keywords: ["‡∏£‡∏≤‡∏Ñ‡∏≤", "‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á", "‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó", "‡πÅ‡∏û‡∏á‡πÑ‡∏´‡∏°", "‡∏Ñ‡∏¥‡∏î‡πÄ‡∏á‡∏¥‡∏ô"],
                response: "‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á‡πÄ‡∏£‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏ö‡∏≤‡πÜ ‡πÅ‡∏Ñ‡πà 25 ‡∏ö‡∏≤‡∏ó‡πÄ‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡∏Ñ‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á ‡∏•‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö",
                link: "https://tuikub.github.io/paypoint/c.html",
                linkText: "üí∞ ‡∏î‡∏π‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤"
            },
            {
                keywords: ["‡∏ï‡∏±‡∏î‡∏£‡∏≠‡∏ö", "‡∏™‡πà‡∏á‡∏ó‡∏±‡∏ô‡πÑ‡∏´‡∏°", "‡∏õ‡∏¥‡∏î‡∏Å‡∏µ‡πà‡πÇ‡∏°‡∏á", "‡∏£‡∏≠‡∏ö‡∏™‡πà‡∏á"],
                response: "‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏£‡∏≤‡∏ï‡∏±‡∏î‡∏£‡∏≠‡∏ö 16.00 ‡∏ô. ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ñ‡πâ‡∏≤‡∏°‡∏≤‡∏ó‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏µ‡πâ ‡∏Ç‡∏≠‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö‡∏ú‡∏°",
                link: "https://tuikub.github.io/paypoint/c.html",
                linkText: "‡∏î‡∏π‡∏£‡∏≠‡∏ö‡∏™‡πà‡∏á"
            },
            {
                keywords: ["‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡πà‡∏≤‡∏á‡πÑ‡∏Å‡∏•", "‡πÄ‡∏Å‡∏≤‡∏∞", "‡∏î‡∏≠‡∏¢", "3 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î", "‡∏ö‡∏ß‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°"],
                response: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏¥‡πÄ‡∏®‡∏© (‡πÄ‡∏Å‡∏≤‡∏∞/‡∏î‡∏≠‡∏¢/3 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î) ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö (20-50 ‡∏ö‡∏≤‡∏ó) ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡πà‡∏á KEX (Kerry) ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏ß‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö ‡∏Ñ‡∏∏‡πâ‡∏°‡∏°‡∏≤‡∏Å!",
                link: "https://tuikub.github.io/tracking/remote.html",
                linkText: "‡∏î‡∏π‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡πà‡∏≤‡∏á‡πÑ‡∏Å‡∏•"
            },
            {
                keywords: ["cod", "‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á", "‡πÇ‡∏≠‡∏ô‡∏ß‡∏±‡∏ô‡πÑ‡∏´‡∏ô"],
                response: "‡∏¢‡∏≠‡∏î COD ‡∏à‡∏∞‡πÇ‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 3-5 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏±‡∏ö (‡πÑ‡∏°‡πà‡∏ô‡∏±‡∏ö‡πÄ‡∏™‡∏≤‡∏£‡πå-‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå) ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏µ‡πâ‡∏ó‡∏±‡∏Å‡∏°‡∏≤‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö",
                link: "https://tuikub.github.io/tracking/cod.html",
                linkText: "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î COD"
            },
            {
                keywords: ["‡πÅ‡∏û‡πá‡∏Ñ", "‡∏´‡πà‡∏≠‡∏Ç‡∏≠‡∏á", "‡∏Å‡∏•‡πà‡∏≠‡∏á", "‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏û‡πá‡∏Ñ", "‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß", "‡∏´‡πâ‡∏≤‡∏°‡∏™‡πà‡∏á"],
                response: "‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏´‡πà‡∏≠‡∏ö‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡πâ‡∏•‡∏´‡∏ô‡∏≤‡πÜ ‡∏≠‡∏±‡∏î‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡∏ô ‡∏õ‡∏¥‡∏î‡πÄ‡∏ó‡∏õ‡∏ï‡∏±‡∏ß H ‡∏Ñ‡∏£‡∏±‡∏ö (‡∏á‡∏î‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß/‡∏Ç‡∏≠‡∏á‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö)",
                link: "https://tuikub.github.io/tracking/prohibited.html",
                linkText: "‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏û‡πá‡∏Ñ‡∏Ç‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏´‡πâ‡∏≤‡∏°"
            },
            {
                keywords: ["‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô", "‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡∏Å", "‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢", "‡πÄ‡∏Ñ‡∏•‡∏°", "‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö"],
                response: "‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏ä‡∏¥‡πâ‡∏ô (‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 2,000 ‡∏ö‡∏≤‡∏ó) ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏´‡∏≤‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢ ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏Ç‡∏≠‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ï‡∏≠‡∏ô‡πÅ‡∏Å‡∏∞‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏•‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö",
                link: "https://tuikub.github.io/tracking/warranty.html",
                linkText: "‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô"
            },
            {
                keywords: ["‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á", "‡πÇ‡∏î‡∏ô‡∏õ‡∏£‡∏±‡∏ö", "‡∏´‡∏±‡∏Å‡πÄ‡∏á‡∏¥‡∏ô", "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô"],
                response: "‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏¢‡∏≠‡∏î‡∏´‡∏±‡∏Å‡πÄ‡∏á‡∏¥‡∏ô ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡πà‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á '‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤' ‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÑ‡∏ß‡πâ‡∏ô‡πà‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏á‡∏ß‡∏•‡∏ô‡∏∞ ‡∏¢‡∏∑‡πà‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡∏ö",
                link: "https://tuikub.github.io/paypoint/Digital.html",
                linkText: "‡∏ß‡∏¥‡∏ò‡∏µ‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á"
            },
            {
                keywords: ["‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á", "‡∏≠‡∏∏‡∏ó‡∏ò‡∏£‡∏ì‡πå", "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á", "‡∏Ç‡∏≠‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏∑‡∏ô"],
                response: "‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà 'Digital Dispute' ‡πÉ‡∏´‡πâ‡∏£‡πâ‡∏≤‡∏ô‡∏¢‡∏∑‡πà‡∏ô‡∏≠‡∏∏‡∏ó‡∏ò‡∏£‡∏ì‡πå‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 5 ‡∏ß‡∏±‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö",
                link: "https://tuikub.github.io/paypoint/Digital.html",
                linkText: "‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á"
            },
            {
                keywords: ["‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ", "‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠", "‡∏ó‡∏≥‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô", "‡∏™‡∏≠‡∏ô‡∏´‡∏ô‡πà‡∏≠‡∏¢"],
                response: "‡πÄ‡∏£‡∏≤‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö ‡∏•‡∏≠‡∏á‡∏Å‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏î‡∏π‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡πÑ‡∏î‡πâ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô",
                link: "https://tuikub.github.io/paypoint/#system",
                linkText: "üìò ‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô"
            },
            {
                keywords: ["‡πÅ‡∏ü‡∏£‡∏ô‡πÑ‡∏ä‡∏™‡πå", "‡∏™‡∏ô‡πÉ‡∏à‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡πâ‡∏≤‡∏ô", "‡∏•‡∏á‡∏ó‡∏∏‡∏ô", "‡∏™‡∏°‡∏±‡∏Ñ‡∏£"],
                response: "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏°‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß Paypoint ‡∏Å‡∏±‡∏ô ‡∏™‡∏ô‡πÉ‡∏à‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ü‡∏£‡∏ô‡πÑ‡∏ä‡∏™‡πå ‡πÇ‡∏ó‡∏£‡∏°‡∏≤‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà 086-888-3656 ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö",
                link: "https://tuikub.github.io/tracking/franchise.html",
                linkText: "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ü‡∏£‡∏ô‡πÑ‡∏ä‡∏™‡πå"
            }
        ];

        // --- 2. API CONFIGURATION (n8n Webhook) ---
        const API_URL = "https://n8n.srv1265116.hstgr.cloud/webhook/chat"; 

        // --- 3. UI LOGIC ---
        const chatWindow = document.getElementById('chat-window');
        const chatToggleBtn = document.getElementById('chat-toggle-btn');
        const messagesContainer = document.getElementById('chat-messages');
        const userInput = document.getElementById('user-input');
        const loadingIndicator = document.getElementById('loading-indicator');
        let isChatOpen = false;

        function toggleChat() {
            isChatOpen = !isChatOpen;
            if (isChatOpen) {
                chatWindow.classList.remove('hidden');
                setTimeout(() => {
                    chatWindow.classList.remove('scale-95', 'opacity-0');
                    chatWindow.classList.add('scale-100', 'opacity-100');
                    userInput.focus();
                }, 10);
                chatToggleBtn.classList.add('hidden');
            } else {
                chatWindow.classList.remove('scale-100', 'opacity-100');
                chatWindow.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    chatWindow.classList.add('hidden');
                    chatToggleBtn.classList.remove('hidden');
                }, 300);
            }
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function sendQuickMsg(msg) {
            userInput.value = msg;
            sendMessage();
        }

        function appendMessage(sender, text, link = null, linkText = "‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà") {
            const isUser = sender === 'user';
            const alignClass = isUser ? 'items-end' : 'items-start';
            const bgClass = isUser ? 'bg-blue-600 text-white rounded-tr-none' : 'bg-white text-gray-700 border border-gray-100 rounded-tl-none';
            const icon = isUser ? '' : `<div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-xs shrink-0 mr-2"><i class="fa-solid fa-robot"></i></div>`;
            
            let contentHtml = text;
            if (link) {
                contentHtml += `<br><a href="${link}" target="_blank" class="inline-block mt-2 px-3 py-1 bg-blue-50 text-blue-600 rounded-lg text-xs font-semibold hover:bg-blue-100 transition"><i class="fa-solid fa-link mr-1"></i> ${linkText}</a>`;
            }

            const msgHTML = `
                <div class="chat-message flex ${alignClass} mb-4 ${isUser ? 'justify-end' : ''}">
                    ${!isUser ? icon : ''}
                    <div class="${bgClass} px-4 py-2.5 rounded-2xl shadow-sm max-w-[85%] text-sm leading-relaxed">
                        ${contentHtml}
                    </div>
                </div>
            `;

            messagesContainer.insertAdjacentHTML('beforeend', msgHTML);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        async function sendMessage() {
            const text = userInput.value.trim();
            if (!text) return;

            // 1. User Message
            appendMessage('user', text);
            userInput.value = '';
            
            // 2. Show Loading
            loadingIndicator.classList.remove('hidden');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            // 3. Logic: Check Local Knowledge Base First (Quick Reply from Sheet Data)
            const foundAnswer = checkKnowledgeBase(text);

            if (foundAnswer) {
                setTimeout(() => {
                    loadingIndicator.classList.add('hidden');
                    appendMessage('bot', foundAnswer.response, foundAnswer.link, foundAnswer.linkText);
                }, 600);
            } else {
                // 4. Fallback: Call n8n Webhook
                try {
                    const aiResponse = await callN8NWebhook(text);
                    loadingIndicator.classList.add('hidden');
                    appendMessage('bot', aiResponse);
                } catch (error) {
                    loadingIndicator.classList.add('hidden');
                    appendMessage('bot', "‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Server ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö üòì");
                    console.error("API Error:", error);
                }
            }
        }

        function checkKnowledgeBase(query) {
            query = query.toLowerCase();
            for (const item of knowledgeBase) {
                for (const keyword of item.keywords) {
                    if (query.includes(keyword)) {
                        return item;
                    }
                }
            }
            return null;
        }

        async function callN8NWebhook(userText) {
            // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà n8n
            // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: key 'chatInput' ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö n8n Chat Trigger 
            // ‡∏´‡∏≤‡∏Å n8n ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ key ‡∏≠‡∏∑‡πà‡∏ô ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ (‡πÄ‡∏ä‡πà‡∏ô 'message', 'text', 'query')
            const payload = {
                chatInput: userText 
            };

            const response = await fetch(API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) throw new Error('Network response was not ok');
            
            const data = await response.json();
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ n8n ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏ô field ‡πÑ‡∏´‡∏ô (output, text, ‡∏´‡∏£‡∏∑‡∏≠ message)
            // ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏° Response ‡∏Ç‡∏≠‡∏á n8n ‡∏Ñ‡∏∏‡∏ì
            return data.output || data.text || data.message || JSON.stringify(data);
        }

    </script>
</body>
</html>
